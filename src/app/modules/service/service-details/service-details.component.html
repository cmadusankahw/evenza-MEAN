<div class="container-fluid" *ngIf="!editmode && !addnew">

  <div class="row f-image">

    <mdb-carousel class="carousel slide carousel-fade" [animation]="'fade'">
      <mdb-carousel-item>
        <div class="view w-100" *ngIf="services[0].feature_img">
          <img class="d-block w-100" src={{services[0].feature_img}} alt="Feature Image 1" class="feature-img">
          <div class="mask rgba-black-light waves-light" mdbWavesEffect></div>
        </div>
      </mdb-carousel-item>
      <mdb-carousel-item>
        <div class="view w-100" *ngIf="services[0].image_01">
          <img class="d-block w-100" src={{services[0].image_01}} alt="Feature Image 2" class="feature-img">
          <div class="mask rgba-black-strong waves-light" mdbWavesEffect></div>
        </div>
      </mdb-carousel-item>
      <mdb-carousel-item>
        <div class="view w-100" *ngIf="services[0].image_02">
          <img class="d-block w-100" src={{services[0].image_02}} alt="Feature Image 3" class="feature-img">
          <div class="mask rgba-black-slight waves-light" mdbWavesEffect></div>
        </div>
      </mdb-carousel-item>
      <mdb-carousel-item>
        <div class="view w-100" *ngIf="services[0].image_03">
          <img class="d-block w-100" src={{services[0].image_03}} alt="Feature Image 4" class="feature-img">
          <div class="mask rgba-black-slight waves-light" mdbWavesEffect></div>
        </div>
      </mdb-carousel-item>
    </mdb-carousel>



  </div>
    <div class="row">
      <div class="col-md-7">
        <div class="content-title">
          {{services[0].service_name}}
        </div>
        <div class="open-stat" *ngIf="services[0].available_booking">
          <a mdbWavesEffect role="button" (click)="opendays.show()">
          <span><mdb-icon far icon="clock"> </mdb-icon> {{'Service is Available'}}</span>
          </a>
        </div>

        <div class="open-stat" *ngIf="!services[0].available_booking">
          <a mdbWavesEffect role="button" disabled >
          <span style="color:darkred;"><mdb-icon far icon="clock"> </mdb-icon> {{'Service not Available'}}</span>
          </a>
        </div>

      </div>

      <!--if editb=able by merchant-->
      <div class="col-md-5 edit-cls" *ngIf="isowner">
          <a mdbBtn color="secondary" class="btn btn-md edit-btn" mdbWavesEffect
          (click)="editmode = !editmode">Edit Details</a>
      </div>

      <!--if only shown to users-->
      <div class="col-md-5 edit-cls" *ngIf="!isowner">
        <a mdbBtn color="secondary" outline="yes" class="btn btn-lg book-btn" mdbWavesEffect>Book Now</a>
      </div>

    </div>


      <hr>
      <div class="row">
        <div class=" col-md-7 content-text">
          {{services[0].description}}
          <br>
          <div class="category">
            <mdb-icon far icon="calendar-alt"></mdb-icon> Categry: {{services[0].service_category}}
          </div>
          <div class="notify" >
            <mdb-icon far icon="calendar-check"> </mdb-icon> {{(services[0].payment_type == 'Pay on Meet') ? 'Pay on Meet Available' : 'Pay Online'}}
          </div>
          <br>
          <div class="notify" *ngIf="isowner">
            <mdb-icon fas icon="bookmark"> </mdb-icon> {{services[0].no_of_bookings}} Active Bookings
            <br>
            <mdb-icon far icon="calendar-check"> </mdb-icon> {{services[0].no_of_appoints}} Active Appointments
          </div>
        </div>

        <!--hourly rate-->
        <div class="col-md-5">
          <div class="hr-rate">
            <span class="hr-price"> Rs. {{services[0].rate}}</span>
            <span class="hr-text"> {{services[0].rate_type}}</span>
          </div>
          <hr>

          <!--service ratings-->
            <div class="rating">
              <ngb-rating [(rate)]="services[0].rating" max="5">
                <ng-template let-fill="fill" let-index="index">
                  <span class="star" [class.filled]="fill === 100">&#9733;</span>
                </ng-template>
              </ngb-rating>
              <br>
              <span class="rating-txt">
                {{services[0].no_of_ratings}} Recommended
              </span>
            </div>
          <hr>
          <div class="owner text-center" >
            <span>Owned by {{services[0].business_name}}</span>
            <br>
            <a mdbBtn color="secondary" class="btn btn-md" outline="yes" mdbWavesEffect *ngIf="!isowner"
              (click)="showBprofile()" >View Business</a>
          </div>

        </div>
      </div>

      <hr>

</div>

<!--editnew service-->
<div class="container-fluid text-center" *ngIf="editmode">
  <div class="center-txt">
    <div class="row">
      <div class="col-md-8">
        <p style="line-height:35px;"> You can change the details of <b>{{services[0].service_name}}</b> below.</p>
      </div>
      <div class="col-md-4">
        <a role="button" mdbBtn class="btn btn-sm" color="red" text="white" (click)="removeService()"> Remove Service</a>
      </div>
    </div>
  </div>
  <br>
    <form class="service-form">
      <mat-form-field class="service-full-width">
        <mat-label>Service Title</mat-label>
        <input matInput placeholder="Service Title here" value="{{services[0].service_name}}" required>
      </mat-form-field>
      <br>

      <mat-form-field class="service-full-width">
        <mat-label >Select Service Category</mat-label>
        <select matNativeControl required>
          <option  value={{cat.id}} *ngFor="let cat of categories">
            {{cat.val}}</option>
        </select>
      </mat-form-field>
      <br>
        <div class="check-cls">
          <mat-label class="check-label">Service Availability</mat-label>
          <mat-checkbox class="check-margin" >Available for Booking</mat-checkbox>
          <mat-checkbox class="check-margin" >Available for Appointments</mat-checkbox>
        </div>
        <br>
        <div class="check-cls">
          <mat-label class="check-label">Available Days and Times </mat-label>
          <mat-checkbox class="check-margin"  [checked]="services[0].open_days_as_business"
          (change)="services[0].open_days_as_business = !services[0].open_days_as_business"> Same as Business </mat-checkbox>
          <button mdbBtn color="secondary" class="btn btn-md" outline="yes" mdbWavesEffect
          (click)="opendays.show()"  [disabled]="services[0].open_days_as_business">Change Availability</button>
        </div>

      <br>
      <mat-form-field class="service-full-width">
        <mat-label class="check-label">Service Description</mat-label>
        <textarea matInput rows="5" placeholder="Service Description">
          {{services[0].description}}
        </textarea>
      </mat-form-field>
      <br>

      <div class="row">

        <div class="col">
          <mat-form-field class="service-full-width-sm">
            <mat-label >Service Rate Type</mat-label>
            <select matNativeControl required>
             <option  value={{rate.id}} *ngFor="let rate of rates">
                {{rate.val}}</option>
            </select>
          </mat-form-field>
        </div>

        <div class="col">
          <mat-form-field class="service-full-width-sm">
            <mat-label>Service Rate(Rs.)</mat-label>
            <input matInput placeholder="Service Rate here" value="{{services[0].rate}}" required>
          </mat-form-field>
        </div>
      </div>

      <div class="text-center">
        <mat-form-field class="service-full-width-sm">
          <mat-label >Payment Type</mat-label>
          <select matNativeControl required>
           <option  value={{ptype.id}} *ngFor="let ptype of paymentTypes">
              {{ptype.val}}</option>
          </select>
        </mat-form-field>
        <br>
        <p class="pay-on-meet"> Note: If <b>Pay on Meet</b> is selected, <b>no payment</b> will be charged on booking. Payment need to be collected manullay. However, <b>system will charge the due commission form you.</b></p>
      </div>

      <hr>
      <div class="enter-txt">
        <p> Upload images related to your service (up to 3 images *5MB Max)</p>
      </div>
      <div class="row">
        <div class="col-md-4">
          <a role="button" mdbWavesEffect (click)="sidea.click()">
            <img src="{{services[0].image_01}}" alt="front side" class="img-cls">
          </a>
          <input type="file" hidden="true" id="sidea" #sidea>
          <p><b>Image 01</b></p>
        </div>

        <div class="col-md-4">
          <a role="button" mdbWavesEffect (click)="sideb.click()">
            <img src="{{services[0].image_02}}" alt="front side" class="img-cls">
          </a>
          <input type="file" hidden="true" id="sideb" #sideb>
          <p><b>Image 02</b></p>
        </div>

        <div class="col-md-4">
          <a role="button" mdbWavesEffect (click)="sidec.click()">
            <img src="{{services[0].image_03}}" alt="front side" class="img-cls">
          </a>
          <input type="file" hidden="true" id="sidec" #sidec>
          <p><b>Image 03</b></p>
        </div>
      </div>

    </form>
    <hr>
  <!--back button only if !addnew-->
  <div class="btns">
    <a mdbBtn color="secondary" class="btn btn-md edtbt" mdbWavesEffect
  (click)="editmode = !editmode" >Save Changes</a>
  <a mdbBtn color="secondary" class="btn btn-md edtbt" outline="yes" mdbWavesEffect
  (click)="editmode = !editmode" >Discard</a>
  </div>
</div>

<!--add new service-->
<div class="container-fluid text-center" *ngIf="addnew">
  <div class="center-txt">
    <p> To create a new service, fill details below...</p>
  </div>
  <br>
    <form class="service-form">
      <mat-form-field class="service-full-width">
        <mat-label>Service Title</mat-label>
        <input matInput placeholder="Service Title here"  required>
      </mat-form-field>
      <br>

      <mat-form-field class="service-full-width">
        <mat-label >Select Service Category</mat-label>
        <select matNativeControl required>
          <option  value={{cat.id}} *ngFor="let cat of categories">
            {{cat.val}}</option>
        </select>
      </mat-form-field>
      <br>
        <div class="check-cls">
          <mat-label class="check-label">Service Availability</mat-label>
          <mat-checkbox class="check-margin" >Available for Booking</mat-checkbox>
          <mat-checkbox class="check-margin" >Available for Appointments</mat-checkbox>
        </div>
        <br>
        <div class="check-cls">
          <mat-label class="check-label">Available Days and Times</mat-label>
          <mat-checkbox class="check-margin" [checked]="temp_open"
          (change)="temp_open = !temp_open">Same as Business</mat-checkbox>
          <button mdbBtn color="secondary" class="btn btn-md" outline="yes" mdbWavesEffect
          (click)="opendays.show()"  [disabled]="temp_open">Change Availability</button>
        </div>
      <br>
      <mat-form-field class="service-full-width">
        <mat-label class="check-label">Service Description</mat-label>
        <textarea matInput rows="5" placeholder="Service Description">
        </textarea>
      </mat-form-field>
      <br>

      <div class="row">

        <div class="col">
          <mat-form-field class="service-full-width-sm">
            <mat-label >Service Rate Type</mat-label>
            <select matNativeControl required>
             <option  value={{rate.id}} *ngFor="let rate of rates">
                {{rate.val}}</option>
            </select>
          </mat-form-field>
        </div>

        <div class="col">
          <mat-form-field class="service-full-width-sm">
            <mat-label>Service Rate(Rs.)</mat-label>
            <input matInput placeholder="0.00"  required>
          </mat-form-field>
        </div>
      </div>

        <div class="text-center">
          <mat-form-field class="service-full-width-sm">
            <mat-label >Payment Type</mat-label>
            <select matNativeControl required>
             <option  value={{ptype.id}} *ngFor="let ptype of paymentTypes">
                {{ptype.val}}</option>
            </select>
          </mat-form-field>
          <br>
          <p class="pay-on-meet"> Note: If <b>Pay on Meet</b> is selected, <b>no payment</b> will be charged on booking. Payment need to be collected manullay. However, <b>system will charge the due commission form you.</b></p>
        </div>
      <hr>
      <div class="enter-txt">
        <p> Upload feature Images related to your service (up to 3 images *5MB Max)</p>
      </div>
      <div class="row">
        <div class="col-md-4">
          <a role="button" mdbWavesEffect (click)="sidea.click()">
            <img src="./assets/images/merchant/nopic.png" alt="front side" class="img-cls">
          </a>
          <input type="file" hidden="true" id="sidea" #sidea>
          <p><b>Image 01</b></p>
        </div>

        <div class="col-md-4">
          <a role="button" mdbWavesEffect (click)="sideb.click()">
            <img src="./assets/images/merchant/nopic.png" alt="front side" class="img-cls">
          </a>
          <input type="file" hidden="true" id="sideb" #sidea>
          <p><b>Image 02</b></p>
        </div>

        <div class="col-md-4">
          <a role="button" mdbWavesEffect (click)="sidec.click()">
            <img src="./assets/images/merchant/nopic.png" alt="front side" class="img-cls">
          </a>
          <input type="file" hidden="true" id="sidec" #sidea>
          <p><b>Image 03</b></p>
        </div>
      </div>

    </form>
    <hr>
  <!--back button only if !addnew-->
  <div class="btns">
    <a mdbBtn color="secondary" class="btn btn-md edtbt" mdbWavesEffect
  (click)="createService()" >Create Service</a>
  </div>
</div>

<!--open days Modal-->
<div
  mdbModal
  #opendays="mdbModal"
  class="modal fade"
  tabindex="-1"
  role="dialog"
  aria-labelledby="myBasicModalLabel"
  [config]="{ backdrop: false, ignoreBackdropClick: true }"
  aria-hidden="true"
>
  <div
    class="modal-dialog modal-dialog-centered"
    role="document"
    style="overflow-y: initial !important"
  >
    <div class="modal-content">
      <div class="modal-header">
        <button
          type="button"
          class="close pull-right"
          aria-label="Close"
          (click)="opendays.hide()"
        >
          <span aria-hidden="true">×</span>
        </button>
        <h4 class="modal-title w-100" id="myModalLabel" >
          Available Times
        </h4>
      </div>
      <div class="modal-body " style="height: 400px; overflow-y: auto;" >
         <app-business-open-days [editmode]="false"></app-business-open-days>
      </div>

      <div class="modal-footer">
        <button
          mdbBtn
          color="link"
          (click)="opendays.hide()"
          mdbWavesEffect
        >
          Close
        </button>
      </div>
    </div>
  </div>
</div>
